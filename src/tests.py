from util import *
from sha256 import *

assert string_to_binary('hello') == '0110100001100101011011000110110001101111'
assert string_to_binary('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa') == '01100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001'

assert get_next_multiple_of_512(0) == 512
assert get_next_multiple_of_512(1) == 512
assert get_next_multiple_of_512(512) == 512
assert get_next_multiple_of_512(513) == 1024
assert get_next_multiple_of_512(723) == 1024
assert get_next_multiple_of_512(1024) == 1024
assert get_next_multiple_of_512(1467) == 1536

assert preprocessing('abcde') == '01100001011000100110001101100100011001011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101000'

#0111101101000011001010110110001101100011 - expected value
#1111001101000011001010110110001101100011 - resulting value
assert rightrotate(string_to_binary('hello'),5)=='0111101101000011001010110110001101100011'
assert rightshift(string_to_binary('hello'),5)=='0000001101000011001010110110001101100011'

#print(rightshift(string_to_binary('hello'),5))
#print(rightrotate(string_to_binary('hello'),5))

assert get_512_bit_chunks('0' * 512) == ['0' * 512]
assert get_512_bit_chunks('1' * 512 + '0' * 512) == ['1' * 512, '0' * 512]
assert get_512_bit_chunks('00110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011011' + '00110001100011000110001100011000110001100011000110001100011000110001100011000110001000011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100010000110001100011000110001100011000110001100011000110001100011000110101100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000010001100011000110001100011000110001100011000110001100011000110001110011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011011') == ['00110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011011', '00110001100011000110001100011000110001100011000110001100011000110001100011000110001000011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100010000110001100011000110001100011000110001100011000110001100011000110101100011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011000010001100011000110001100011000110001100011000110001100011000110001110011000110001100011000110001100011000110001100011000110001100011000110001100011000110001100011011']


assert tXor(string_to_binary('hello'),string_to_binary('hello'))=='0000000000000000000000000000000000000000'
assert tAnd(string_to_binary('hello'),string_to_binary('hello'))=='1111111111111111111111111111111111111111'
# sha256("hello")==b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9
#assert testSha(w)=="b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9"
assert bitAdd("010","010")=="100"